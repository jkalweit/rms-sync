<html>
<head>
<link rel="stylesheet" type="text/css" href="/css/app.css">
<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="/SyncNode.js"></script>
<script type="text/javascript" src="/SyncNodeSocket.js"></script>
<script type="text/javascript" src="/SyncView.js"></script>
<script type="text/javascript" src="/parse.js"></script>

<style>



</style>
</head>
<body>


<script id="view" type="text/other">
MenuItemOptionType[item]
	#name[name bold]
	#init:function
		this.node.addEventListener('click', 
			() => { this.emit('selected', this.data); });
	#render:function 
		this.name.innerHTML = this.data.name;


MenuItemOptionTypeList[list]
	#header[header] 'Option Types'
	#newOption:input
	#add:button[btn] 'Add'
		click:
			var newItem = { 
				key: new Date().toISOString(), 
				name: this.newOption.value };
			var result = this.data.set(newItem.key, newItem)[newItem.key];
			this.newOption.value = '';
			this.selected = result;
			this.render();
	#list:List(MenuItemOptionType, name)
		events:
			viewAdded(view): 
				view.on('selected', (type) => {
					this.selected = type;
					typeDetails.update(type);
				});
	#render:function 
			if(this.selected) this.selected = this.data[this.selected.key];	
			typeDetails.update(this.selected);
			this.list.update(this.data);

MenuItemOptionTypeDetails
	#header 'Details'
	#nameInput:SimpleEditInput(name, Name)
	:button[btn] 'Delete'
		events:
			click: 
				//Modal.confirm('Delete?', 'jhg', () => {
					this.data.parent.remove(this.data.key);
					this.update(null);
				//});
	:button[btn] 'Ok'
		events:
			click: 
				this.update(null);
	#init:function 
			this.render();
	#render:function
			if(!this.data) {
				this.node.style.display = 'none';
			} else {
				this.node.style.display = 'block';
				this.nameInput.update(this.data)
			}
	
	

#typesView:MenuItemOptionTypeList[col]
#typeDetails:MenuItemOptionTypeDetails[col]

</script>


</textarea>


<script>
"use strict"

window.SimpleEditInput = SimpleEditInput

SV.startReloader();

var sync = new SyncNodeSocket('/data', {});


SV.onLoad(() => { 
		parse(SV.id('view').innerHTML); 

		sync.on('updated', (data) => {
			if(!data.menu.menuOptions) {
				data.menu.set('menuOptions', { 
					types: {}, 
					options: {} 
				});
			} else { 
				typesView.update(data.menu.menuOptions.types);
			}
		});

});

</script>
</body>
</html>
