<script id="components" type="text/other">

Select[label-set]
	#text[label]
	#selectInput:select
		events:
			change:
				this.selected = this.selectInput.value;
				this.emit('selected', this.selected);
	#init:function(options)
		this.prop = options.prop;
		if(options.label) this.text.innerHTML = options.label;
		else this.text.style.display = 'none';
	#select:function(value)
		this.selectInput.value = value;
		this.selected = this.selectInput.value;
	#render:function
		var selected = this.selectInput.value;
		this.selectInput.innerHTML = '';
		SV.toArray(this.data).forEach((item) => {
			var value = this.prop ? SV.getProperty(item, this.prop) : item;
			SV.el('option', { parent: this.selectInput, innerHTML: value }); 
		});
		this.selectInput.value = selected;
		

LabeledValue[label-set]
	#label[label]
	#value[value]
	#init:function(options)
		this.label.innerHTML = options.label;
		this.prop = options.prop;
	#render:function
		if(this.prop && this.data) this.value.innerHTML = SV.getProperty(this.data, this.prop);


ToggleButton[btn]
	#text:span
	:events
		click:
			console.log('here', this.prop, this.data);
			this.data.set(this.prop, !this.data[this.prop]);
	#init:function(options)
		this.prop = options.prop;
		this.trueText = options.trueText || 'Yes';
		this.falseText = options.falseText || 'No';
	#render:function
		if(this.data) this.text.innerHTML = this.data[this.prop] ? this.trueText : this.falseText;


SimpleHeader[header col-nofill row row-flex]
	#text:span[row-fill]
	#add[row-nofill touch material-icons] 'add'
		events:
			click: 
				this.emit('add');
	#del[row-nofill touch material-icons] 'delete'
		events:
			click: 
				this.emit('delete');
	#more[row-nofill touch material-icons] 'settings'
		events:
			click: 
				this.emit('more');
	#setTitle:function(text)
		this.text.innerHTML = text;
	#close[row-nofill touch material-icons] 'done'
		events:
			click: 
				this.emit('close');
	#init:function(options) 
		this.setTitle(options.text);
		if(!options.add)
			this.add.style.display = 'none';	
		if(!options.close)
			this.close.style.display = 'none';	
		if(!options.more)
			this.more.style.display = 'none';	
		if(!options.del)
			this.del.style.display = 'none';	

SearchHeader[row row-flex]
	:style 
		border-bottom: 1px solid rgba(0,0,0,0.5);
	#searchBox:input[row-fill]
		events:
			keydown(e): 
				if(e.keyCode === 13) this.add();
			keyup(e):
				this.emit('searchChanged', this.searchBox.value);
	#addBtn:div[row-nofill touch material-icons] 'add'
		events:
			click: 
				this.add();
	#clearBtn:div[row-nofill touch material-icons] 'clear'
		events:
			click: 
				this.clear();
	#add:function 
			this.emit('add', this.searchBox.value);
	#clear:function
			this.searchBox.value = '';
			this.emit('searchChanged', this.searchBox.value);
	#init:function(options)
			if(!options.addBtn) this.addBtn.style.display = 'none';
			if(!options.clearBtn) this.clearBtn.style.display = 'none';
			if(!options.searchBox) this.searchBox.style.display = 'none';


SearchList[col-flex]
	#header:SearchHeader({ addBtn: true })[col-noflex]
		events:
			add(value):
				this.emit('add', value);
			searchChanged(value):
				this.search(value);
				this.emit('searchChanged', value);
	#search:function(value)
		value = value || '';
		this.searchValue = value.trim().toLowerCase();
		this.doFilter();
	#doFilter:function() 
		var filtered = this.data;
		if(this.searchProp) {
			if(this.searchValue) {
				filtered = SV.filterMap(this.data, (item) => { 
					var itemVal = item[this.searchProp];
					if(!itemVal) return false;
					return itemVal.trim().toLowerCase().indexOf(this.searchValue) !== -1;	
				});
			}
		}
		if(this.postFilter) filtered = this.postFilter(filtered);
		this.list.update(filtered);

	#init:function(options)
		this.searchProp = options.searchProp;
		this.header.searchBox.style.display = options.searchBox ? 'inline-block' : 'none';
		this.header.addBtn.style.display = options.addBtn ? 'inline-block' : 'none';
		this.header.clearBtn.style.display = options.clearBtn ? 'inline-block' : 'none';
		this.list = this.appendView(new List({ ctor: options.ctor, sort: options.sort, direction: options.direction }));
		this.list.node.classList.add('col-fill');
		this.list.node.classList.add('scroll-y');
		this.list.node.classList.add('list');
		this.list.on('viewAdded', (view) => {
			view.on('selected', (item) => {
					this.select(item.key);
				});
		});
	#clearSearch:function()
		this.header.clear();
		this.search('');
	#select:function(key)
		this.selected = this.data[key];
		this.updateSelected();
		this.emit('selected', this.selected);
	#updateSelected:function()
		SV.toArray(this.list.views).forEach((view) => {
			var isSelected = this.selected ? this.selected.key === view.data.key : false;
			view.node.classList.toggle('selected', isSelected);
			if(isSelected) view.node.scrollIntoViewIfNeeded();
		});
	#render:function()
		this.doFilter();
		if(this.selected) this.selected = this.data[this.selected.key];
		this.updateSelected();
	
SimpleList[col-flex]
	#init:function(options)
		this.list = this.appendView(new List({ ctor: options.ctor, sort: options.sort, direction: options.direction }));
		this.list.node.classList.add('col-fill');
		this.list.node.classList.add('scroll-y');
		this.list.node.classList.add('list');
		this.list.on('viewAdded', (view) => {
			view.on('selected', (item) => {
					this.select(item);
				});
		});
	#select:function(item)
		this.emit('selected', item);
	#render:function()
		this.list.update(this.data);
		
</script>
